(this["webpackJsonpjs-book-store"]=this["webpackJsonpjs-book-store"]||[]).push([[0],{36:function(e,t,c){},42:function(e,t,c){},44:function(e,t,c){},46:function(e,t,c){},47:function(e,t,c){},48:function(e,t,c){},49:function(e,t,c){"use strict";c.r(t);var r=c(1),a=c.n(r),n=c(18),s=c.n(n),i=(c(36),c(3)),o=c(13),l=c(6),d=c(7),u=c.p+"static/media/unknown-guy.540f68f7.svg",j=c(5),b=c.n(j),O=c(9),h=c(29),m=c(30),p=function(){function e(){Object(h.a)(this,e),this.URL="https://js-band-store-api.glitch.me"}return Object(m.a)(e,[{key:"query",value:function(){var e=Object(O.a)(b.a.mark((function e(t,c,r,a){var n,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,fetch(this.URL+c,{method:t,headers:{"Content-Type":"application/json;charset=utf-8",Authorization:!!r&&"Bearer ".concat(r)},body:JSON.stringify(a)});case 4:return s=e.sent,e.t0=s.ok,e.next=8,s.json();case 8:e.t1=e.sent,n={ok:e.t0,data:e.t1},e.next=15;break;case 12:e.prev=12,e.t2=e.catch(1),n={ok:!1,data:{message:"Network error, please, try again"}};case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t,c,r,a){return e.apply(this,arguments)}}()},{key:"signin",value:function(){var e=Object(O.a)(b.a.mark((function e(t){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query("POST","/signin",!1,{username:t});case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadBooks",value:function(){var e=Object(O.a)(b.a.mark((function e(t){var c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query("GET","/books",t);case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadBookById",value:function(){var e=Object(O.a)(b.a.mark((function e(t,c){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query("GET","/books/".concat(t),c);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,c){return e.apply(this,arguments)}}()},{key:"purchase",value:function(){var e=Object(O.a)(b.a.mark((function e(t,c){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query("POST","/purchase",c,{books:t});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(t,c){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){var t;return e.instance=null!==(t=e.instance)&&void 0!==t?t:new e,e.instance}}]),e}();p.instance=null;var x="AUTH_USER",f="AUTH_USER_ERROR",v="CLEAR_USER_ERROR",g="AUTH_USER_LOADING",N="CLEAR_USER",y=p.getInstance(),k=(c(42),c(0));function C(e){return"span"===e.as?Object(k.jsx)("span",{"data-testid":"spinner-span",className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):Object(k.jsx)("div",{"data-testid":"spinner-div",className:"spinner-border d-block mx-auto mt-5",role:"status",children:Object(k.jsx)("span",{className:"sr-only",children:"Loading..."})})}var S=function(e){var t=e.handleSubmitForm,c=e.username,a=e.errorText,n=Object(i.c)((function(e){return e.user})),s=Object(d.a)(c,2),o=s[0],l=s[1],u=Object(r.useCallback)((function(e){var t=e.target;l(t.value.trim())}),[l]);return Object(k.jsxs)("form",{"data-testid":"login-form",onSubmit:t,children:[Object(k.jsxs)("div",{className:"form-group",children:[Object(k.jsx)("label",{htmlFor:"username-input",className:"w-100",children:"Name"}),Object(k.jsx)("input",{id:"username-input","data-testid":"username-input",type:"text",className:"form-control ".concat(a?"is-invalid":""),placeholder:"Dasha...",value:o,onChange:u}),Object(k.jsx)("div",{className:"invalid-feedback ",children:a})]}),Object(k.jsxs)("button",{className:"btn btn-primary btn-block",type:"submit",disabled:n.isLoading,children:[n.isLoading&&Object(k.jsx)(C,{as:"span"}),"Log in"]})]})};var E=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),c=t[0],a=t[1],n=Object(r.useState)(null),s=Object(d.a)(n,2),o=s[0],l=s[1],j=Object(i.b)(),h=Object(i.c)((function(e){return e.user}));return Object(k.jsxs)("div",{"data-testid":"Login",className:"card login-card",children:[Object(k.jsx)("div",{className:"card-header",children:"Login"}),Object(k.jsx)("img",{className:"card-img-top px-5 pt-4",src:u,alt:"avatar"}),null===h.token&&Object(k.jsx)("div",{className:"card-body",children:Object(k.jsx)(S,{handleSubmitForm:function(e){e.preventDefault(),c.length<4||c.length>16?l("Username is not valid"):(l(null),j(function(e){return function(){var t=Object(O.a)(b.a.mark((function t(c){var r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c({type:g}),t.next=3,y.signin(e);case 3:r=t.sent,c({type:r.ok?x:f,payload:r.data}),r.ok&&localStorage.setItem("authUser",JSON.stringify(r.data));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(c)))},username:[c,a],errorText:o})}),null!==h.token&&Object(k.jsxs)("div",{className:"card-body text-center",children:[Object(k.jsxs)("h3",{children:["Welcome,"," ",h.username]}),Object(k.jsx)("h6",{className:"text-muted",children:"Redirecting..."})]})]})};var w=function(e){var t=e.history,c=Object(i.c)((function(e){return e.user}));return Object(r.useEffect)((function(){document.title="Login",null!==c.token&&setTimeout((function(){t.replace("/books")}),2e3)}),[c.token,t]),Object(k.jsx)("div",{className:"container full-height",children:Object(k.jsx)("div",{className:"row justify-content-center h-100",children:Object(k.jsx)("div",{className:"col-sm-6 col-xl-4",children:Object(k.jsx)("div",{className:"d-flex flex-column justify-content-center h-100",children:Object(k.jsx)(E,{})})})})})};c(44);function L(e){var t=e.product,c=t.id,r=t.title,a=t.price,n=t.cover,s=t.author;return Object(k.jsxs)("div",{className:"card mb-4 product",children:[Object(k.jsx)("img",{className:"card-img-top product-img","data-testid":"cover",src:n,alt:r}),Object(k.jsxs)("div",{className:"card-body",children:[Object(k.jsx)("h5",{className:"card-title","data-testid":"title",children:r}),Object(k.jsx)("h6",{className:"card-subtitle mb-2 text-muted","data-testid":"author",children:s}),Object(k.jsxs)("div",{className:"row",children:[Object(k.jsx)("div",{className:"col-lg-5",children:Object(k.jsx)("span",{className:"price","data-testid":"price",children:a})}),Object(k.jsx)("div",{className:"col-lg-7",children:Object(k.jsx)(o.b,{"data-testid":"link",to:"/books/".concat(c),className:"bttn primary",children:"View"})})]})]})]})}function _(e){var t=e.children,c=e.className,r=null!==c&&void 0!==c?c:"";return Object(k.jsx)("div",{className:"container",children:Object(k.jsx)("div",{className:"row ".concat(r),children:t})})}function R(e){var t=e.items;return Object(k.jsx)(_,{children:t.map((function(e){return Object(k.jsx)("div",{"data-testid":"Catalog-item",className:"col-sm-6 col-md-4 col-lg-3",children:Object(k.jsx)(L,{product:e})},e.id)}))})}var A=c.p+"static/media/search.8f973b11.svg",T=c.p+"static/media/filter.10b90230.svg",I="LOAD_BOOKS",P="LOAD_BOOKS_ERROR",B="CLEAR_BOOKS_ERROR",U="LOAD_BOOKS_LOADING",D="LOAD_BOOK_BY_ID",F="LOAD_BOOK_BY_ID_LOADING",K="CLEAR_BOOK_SINGLE",H="FILTER_BOOKS",J="ADD_FILTER_BOOKS_BY_TITLE",G="ADD_FILTER_BOOKS_BY_PRICE",Y="CLEAR_FILTER_BOOKS",q=p.getInstance(),z=function(e){var t=e().books.filterCondition,c=H;try{t.title()&&t.price()&&(c=Y)}catch(r){c=H}return{type:c}};var M=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),c=t[0],a=t[1],n=Object(r.useState)("default"),s=Object(d.a)(n,2),o=s[0],l=s[1],u=Object(i.b)(),j=Object(r.useCallback)((function(e){var t=e.target.value;a(t),u(function(e){return function(t,c){var r=e.trim().toLowerCase();t({type:J,payload:e?function(e){return e.toLowerCase().includes(r)}:function(){return!0}}),t(z(c))}}(t))}),[a,u]),b=Object(r.useCallback)((function(e){var t=e.target.value;l(t),u(function(e){return function(t,c){t({type:"ADD_FILTER_BOOKS_BY_PRICE",payload:"to_25"===e?function(e){return e<25}:"between"===e?function(e){return e>25&&e<50}:"higher_50"===e?function(e){return e>50}:function(){return!0}}),t(z(c))}}(t))}),[l,u]);return Object(k.jsxs)(_,{children:[Object(k.jsx)("div",{className:"col-md-6 col-lg-3",children:Object(k.jsxs)("div",{className:"input-group mb-4",children:[Object(k.jsx)("div",{className:"input-group-prepend",children:Object(k.jsx)("div",{className:"input-group-text",children:Object(k.jsx)("img",{src:A,style:{width:15},alt:"icon"})})}),Object(k.jsx)("input",{"data-testid":"search-book",className:"form-control",placeholder:"Find a book...",value:c,onChange:j})]})}),Object(k.jsx)("div",{className:"col-md-6 col-lg-3",children:Object(k.jsxs)("div",{className:"input-group mb-4",children:[Object(k.jsx)("div",{className:"input-group-prepend",children:Object(k.jsx)("div",{className:"input-group-text",children:Object(k.jsx)("img",{src:T,style:{width:15},alt:"icon"})})}),Object(k.jsxs)("select",{"data-testid":"filter-price",className:"custom-select",value:o,onChange:b,children:[Object(k.jsx)("option",{value:"default",children:"Price..."}),Object(k.jsx)("option",{value:"to_25",children:"< 25"}),Object(k.jsx)("option",{value:"between",children:"25 < price < 50"}),Object(k.jsx)("option",{value:"higher_50",children:"> 50"})]})]})})]})};var $=function(e){var t=e.icon,c=e.message;return Object(k.jsxs)("div",{className:"col text-center text-muted",children:[Object(k.jsx)("img",{src:t,className:"w-25 p-5 mt-5",alt:c,style:{opacity:.2}}),Object(k.jsx)("h3",{children:c})]})},V=_,W=c.p+"static/media/searchNotFound.d4b3b794.svg";var X=function(){return Object(k.jsx)(V,{children:Object(k.jsx)($,{icon:W,message:"No books found..."})})},Z=c.p+"static/media/shopping-cart.c4b03591.svg";c(46);var Q=function(){var e=Object(i.c)((function(e){return e.user})),t=Object(i.c)((function(e){return e.cart})),c=Object(i.b)(),a=Object(r.useCallback)((function(){c((localStorage.removeItem("authUser"),{type:N}))}),[c]);return Object(k.jsxs)("header",{className:"mb-5",children:[Object(k.jsx)("div",{className:"bg-dark text-light",children:Object(k.jsxs)(_,{className:"py-2 justify-content-end",children:[Object(k.jsx)("div",{className:"col-5 col-xs-8 col-md-2 text-right pr-0",children:Object(k.jsxs)("span",{"data-testid":"username",className:"d-inline-block",style:{paddingTop:".2rem"},children:[e.username,Object(k.jsx)("img",{"data-testid":"avatar",src:u,style:{width:26,margin:"-3px 0 0 7px"},className:"rounded",alt:"avatar"})]})}),Object(k.jsx)("div",{className:"col-5 col-xs-4 col-md-2",children:Object(k.jsx)("button",{"data-testid":"sign-out-button",className:"bttn secondary solid btn-sm",type:"button",onClick:a,children:"Sign Out"})})]})}),Object(k.jsx)("div",{className:"border-bottom bg-light",children:Object(k.jsxs)(_,{className:"py-5",children:[Object(k.jsx)("div",{className:"col-7 col-md-10",children:Object(k.jsx)("h2",{className:"header-title",children:Object(k.jsx)(o.b,{to:"/books",children:"JS Book Store"})})}),Object(k.jsx)("div",{className:"col-5 col-md-2",children:Object(k.jsx)("div",{className:"d-flex flex-column justify-content-center h-100",children:Object(k.jsxs)(o.b,{"data-testid":"cart-button",to:"/cart",className:"bttn light",children:[Object(k.jsx)("img",{className:"bttn-img",src:Z,alt:"cart"}),"Cart"," ",Object(k.jsxs)("b",{children:["(",t.length,")"]})]})})})]})})]})};var ee=function(){var e,t=Object(i.c)((function(e){return e.books})),c=Object(i.b)();return Object(r.useEffect)((function(){return document.title="Catalog",c(function(){var e=Object(O.a)(b.a.mark((function e(t){var c,r,a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:U}),r=null!==(c=JSON.parse(localStorage.getItem("authUser")))&&void 0!==c?c:{},a=r.token,e.next=4,q.loadBooks(a);case 4:void 0!==(n=e.sent)?console.log("work"):console.log("null"),t({type:n.ok?I:P,payload:n.data});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),function(){c({type:Y})}}),[c]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(Q,{}),Object(k.jsx)(M,{}),t.isCatalogLoading&&Object(k.jsx)(C,{size:"lg",center:!0}),!t.isCatalogLoading&&Object(k.jsx)(R,{items:null!==(e=t.filteredCatalog)&&void 0!==e?e:t.catalog}),t.filteredCatalog&&0===t.filteredCatalog.length&&Object(k.jsx)(X,{})]})};c(47);var te=function(e){var t=e.product,c=t.title,r=t.author,a=t.cover,n=t.description,s=t.tags;return Object(k.jsx)("div",{className:"card product-desc mb-4",children:Object(k.jsxs)("div",{className:"row flex-column-reverse  flex-sm-row",children:[Object(k.jsxs)("div",{className:"col",children:[Object(k.jsx)("img",{"data-testid":"prod-cover",src:a,className:"product-desc-img w-100",alt:"a"}),Object(k.jsx)("p",{"data-testid":"prod-desc",className:"p-4",children:n})]}),Object(k.jsx)("div",{className:"col",children:Object(k.jsxs)("div",{className:"pt-4 pr-4 pl-4 pl-sm-0",children:[Object(k.jsx)("h3",{"data-testid":"prod-title",children:c}),Object(k.jsx)("span",{"data-testid":"prod-author",className:"text-muted h6",children:r}),Object(k.jsx)("p",{className:"tags",children:s.map((function(e){return Object(k.jsx)("span",{className:"badge badge-secondary",children:e},e)}))})]})})]})})};var ce=function(e){var t=e.price,c=e.totalPrice,a=e.setUserCount,n=e.setTotalPrice,s=Object(r.useCallback)((function(e){return+(e*t).toFixed(2)}),[t]),i=Object(r.useState)(""),o=Object(d.a)(i,2),l=o[0],u=o[1],j=Object(r.useCallback)((function(e){var t=e.target,c=+t.value;c<=42&&c>0?(n(s(c)),a(c),u("")):(t.value="",n(s(t.value)),u("Please enter a valid value between 1 and 42"))}),[s,a,n]);return Object(k.jsxs)("div",{className:"card p-4",children:[Object(k.jsxs)("div",{className:"row",children:[Object(k.jsx)("div",{className:"col",children:Object(k.jsx)("p",{children:"Price, $"})}),Object(k.jsx)("div",{className:"col-md-4 col-xl-3 col-5 text-right",children:Object(k.jsx)("p",{children:t})})]}),Object(k.jsxs)("div",{className:"row",children:[Object(k.jsx)("div",{className:"col",children:Object(k.jsx)("p",{children:"Count"})}),Object(k.jsx)("div",{className:"col-md-4 col-xl-3 col-5 text-right",children:Object(k.jsx)("div",{className:"input-group",style:{marginTop:"-3px"},children:Object(k.jsx)("input",{"data-testid":"price-counter",className:"form-control form-control-sm",type:"number",min:"1",max:"42",onChange:j})})})]}),l&&Object(k.jsx)("div",{className:"row",children:Object(k.jsx)("div",{className:"col",children:Object(k.jsx)("p",{style:{color:"red"},children:l})})}),Object(k.jsxs)("div",{className:"row font-weight-bold",children:[Object(k.jsx)("div",{className:"col",children:Object(k.jsx)("p",{children:"Total Price, $"})}),Object(k.jsx)("div",{className:"col-md-4 col-xl-3 col-5 text-right",children:Object(k.jsx)("p",{"data-testid":"total-price",children:0===a?0:c})})]})]})},re="PUSH_PRODUCT_TO_CART",ae="CLEAR_CART";function ne(e){var t=e.product,c=Object(r.useState)(1),a=Object(d.a)(c,2),n=a[0],s=a[1],o=Object(r.useState)(t.price),l=Object(d.a)(o,2),u=l[0],j=l[1],b=Object(i.b)(),O=Object(r.useCallback)((function(){var e=t.id,c=t.title,r=t.price;b(function(e){return{type:re,payload:e}}({id:e,title:c,userCount:n,price:r,totalPrice:u}))}),[b,t,n,u]);return Object(k.jsxs)(_,{children:[Object(k.jsx)("div",{className:"col-md-8",children:Object(k.jsx)(te,{product:t})}),Object(k.jsxs)("div",{className:"col-md-4 mb-5",children:[Object(k.jsx)(ce,{price:t.price,totalPrice:u,count:t.count,userCount:n,setUserCount:s,setTotalPrice:j}),Object(k.jsx)("div",{className:"pt-4 text-right",children:Object(k.jsx)("button",{"data-testid":"push-to-cart-button",className:"btn btn-success",type:"button",onClick:O,disabled:n<1||n>t.count,children:"Add to cart"})})]})]})}var se=C;var ie=function(e){var t=e.match,c=Object(i.c)((function(e){return e.books})),a=Object(i.b)(),n=t.params.id;return Object(r.useEffect)((function(){return a(function(e){return function(){var t=Object(O.a)(b.a.mark((function t(c){var r,a,n,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c({type:F}),a=null!==(r=JSON.parse(localStorage.getItem("authUser")))&&void 0!==r?r:{},n=a.token,t.next=4,q.loadBookById(e,n);case 4:s=t.sent,c({type:s.ok?D:P,payload:s.data});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(n)),function(){return a({type:K})}}),[n,a]),Object(r.useEffect)((function(){c.single&&(document.title=c.single.title)}),[c.single]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(Q,{}),c.isSingleLoading&&Object(k.jsx)(se,{size:"lg",center:!0}),!c.isSingleLoading&&c.single&&Object(k.jsx)(ne,{product:c.single})]})},oe=c(21);var le=function(e){var t=e.items,c=Object(r.useState)(0),a=Object(d.a)(c,2),n=a[0],s=a[1];return Object(r.useEffect)((function(){var e=t.reduce((function(e,t){return e+t.totalPrice}),0);s(e.toFixed(2))}),[t]),Object(k.jsx)(_,{children:Object(k.jsxs)("div",{className:"col",children:[Object(k.jsx)("div",{className:"card p-4 table-responsive",children:Object(k.jsxs)("table",{className:"table",children:[Object(k.jsx)("thead",{children:Object(k.jsxs)("tr",{children:[Object(k.jsx)("th",{className:"w-75 border-top-0",children:"Name"}),Object(k.jsx)("th",{className:"border-top-0 text-right",children:"Count"}),Object(k.jsx)("th",{className:"border-top-0 text-right",children:"Price"}),Object(k.jsx)("th",{className:"text-right border-top-0",children:"Total"})]})}),Object(k.jsx)("tbody",{children:t.map((function(e){var t=e.key,c=e.title,r=e.userCount,a=e.price,n=e.totalPrice;return Object(k.jsxs)("tr",{"data-testid":"cart-item",children:[Object(k.jsx)("td",{children:c}),Object(k.jsx)("td",{className:"text-right",children:r}),Object(k.jsx)("td",{className:"text-right",children:a}),Object(k.jsx)("td",{className:"text-right",children:n})]},t)}))})]})}),Object(k.jsx)("div",{className:"row mt-4 justify-content-end",children:Object(k.jsx)("div",{className:"col-md-2 col-sm-4 text-right",children:Object(k.jsxs)("b",{children:["Total Price:"," ",n,"$"]})})})]})})},de="PURCHASE_SENDING",ue="PURCHASE_ERROR",je="CLEAR_PURCHASE_ERROR",be="PURCHASE_SUCCESS",Oe="CLEAR_PURCHASE",he=p.getInstance(),me=function(e){return e.reduce((function(e,t){for(var c=t.id,r=t.userCount,a=0;a<r;a+=1)e.push(c);return e}),[])},pe=function(e){return function(){var t=Object(O.a)(b.a.mark((function t(c){var r,a,n,s,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=me(e),c({type:de}),n=JSON.parse(localStorage.getItem("authUser")),s=n.token,t.next=5,he.purchase(a,s);case 5:i=t.sent,c({type:i.ok?be:ue,payload:null!==(r=null===i||void 0===i?void 0:i.data)&&void 0!==r?r:{message:"Network error"}});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()};var xe=function(e){var t=e.isAvialable,c=Object(i.c)((function(e){return e.cart})),a=Object(i.c)((function(e){return e.purchase})),n=Object(i.b)(),s=Object(r.useCallback)((function(){n(pe(c))}),[n,c]);return Object(k.jsx)(_,{children:Object(k.jsx)("div",{className:"col",children:Object(k.jsx)("div",{className:"row mb-4 justify-content-end",children:Object(k.jsx)("div",{className:"col-md-2 col-sm-4",children:Object(k.jsxs)("button",{"data-testid":"purchase-button",className:"bttn primary solid",type:"button",onClick:s,disabled:!t,children:[a.isSending&&Object(k.jsx)(se,{as:"span"}),"Purchase"]})})})})})};var fe=function(){return Object(k.jsx)(V,{children:Object(k.jsx)($,{icon:Z,message:"Cart empty..."})})},ve="OPEN_MODAL",ge="CLOSE_MODAL";var Ne=function(){var e=Object(i.c)((function(e){return e.cart})),t=Object(i.c)((function(e){return e.purchase})),c=Object(i.b)();return Object(r.useEffect)((function(){document.title="Cart (".concat(e.length,")")}),[e.length]),Object(r.useEffect)((function(){t.isSuccess&&c({type:ve,payload:{title:"You successfully placed an order",message:Object(k.jsx)(le,{items:Object(oe.a)(e)}),onClose:function(){c({type:Oe}),c({type:ae})}}})}),[t.isSuccess,c,e]),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(Q,{}),Object(k.jsx)(xe,{isAvialable:e.length>0}),0===e.length&&Object(k.jsx)(fe,{}),e.length>0&&Object(k.jsx)(le,{items:e})]})};var ye=function(){return Object(r.useEffect)((function(){document.title="404 \u2022 Page not found"}),[]),Object(k.jsx)(_,{children:Object(k.jsxs)("div",{className:"col text-center mt-5 pt-5",children:[Object(k.jsx)("img",{alt:"page not found",src:"https://media.giphy.com/media/tvGOBZKNEX0ac/giphy-downsized-large.gif",className:"w-100 mb-3 rounded"}),Object(k.jsx)("h1",{children:"Sorry, page not found"}),Object(k.jsx)("div",{children:Object(k.jsx)(o.b,{className:"btn btn-primary mt-3",to:"/",children:"Return to main page"})})]})})};c(48);var ke=function(e){var t=e.data,c=e.error,a=c?t.errorMessage:t,n=a.title,s=a.message,o=a.onClose,l=Object(r.useRef)(null),d=Object(i.b)(),u=Object(r.useCallback)((function(){c?t.clearError():d({type:ge}),o&&o()}),[d,o,t,c]);return Object(r.useEffect)((function(){var e=l.current,t=function(e){e.target.classList.contains("modal-click")&&u()};return e.addEventListener("click",t),function(){return e.removeEventListener("click",t)}}),[d,u]),Object(k.jsx)("div",{className:"modal-card-wrapp container-fluid",ref:l,children:Object(k.jsx)("div",{"data-testid":"modal-wrapper",className:"row modal-click justify-content-center align-items-center h-100",children:Object(k.jsx)("div",{className:"col-xl-7 col-md-9",children:Object(k.jsxs)("div",{"data-testid":"modal-error",className:"card modal-card ".concat(c?"modal-card-error":""),children:[Object(k.jsx)("div",{className:"card-header pt-3",children:Object(k.jsx)("h5",{"data-testid":"modal-title",children:n})}),Object(k.jsx)("div",{className:"card-body","data-testid":"modal-message",children:s}),Object(k.jsx)("div",{className:"card-footer",children:Object(k.jsx)("div",{className:"row justify-content-end",children:Object(k.jsx)("div",{className:"col-md-3 col-xl-2",children:Object(k.jsx)("button",{"data-testid":"close-modal-button",className:"bttn primary btn-close",type:"button",onClick:u,children:"Close"})})})})]})})})})},Ce=function(){var e=Object(r.useState)(!1),t=Object(d.a)(e,2),c=t[0],a=t[1],n=Object(r.useState)({}),s=Object(d.a)(n,2),o=s[0],l=s[1],u=Object(i.c)((function(e){return e.user})),j=Object(i.c)((function(e){return e.books})),b=Object(i.c)((function(e){return e.purchase})),O=Object(i.b)(),h=Object(r.useCallback)((function(){O({type:B}),O({type:v}),O({type:je})}),[O]);return Object(r.useEffect)((function(){var e=null;u.error?e={title:"Authorization Error",message:u.error.message}:j.error?e={title:"Books Loading Error",message:j.error.message}:b.error&&(e={title:"Purchase Error",message:b.error.message}),a(!!e),l(e)}),[u.error,j.error,b.error]),{isError:c,errorMessage:o,clearError:h}};function Se(){var e=Object(i.c)((function(e){return e.user})),t=Object(i.c)((function(e){return e.modal})),c=Ce(),a=Object(i.b)();return Object(r.useEffect)((function(){a(function(){var e=localStorage.getItem("authUser");return e?{type:x,payload:JSON.parse(e)}:{type:"none"}}())}),[e.token,a]),e.token||localStorage.getItem("authUser")?Object(k.jsxs)(k.Fragment,{children:[c.isError&&Object(k.jsx)(ke,{error:!0,data:c}),t.message&&Object(k.jsx)(ke,{data:t}),Object(k.jsx)(o.a,{basename:"/js-book-store",children:Object(k.jsxs)(l.d,{children:[Object(k.jsx)(l.b,{exact:!0,path:"/",children:Object(k.jsx)(l.a,{to:"/books"})}),Object(k.jsx)(l.b,{exact:!0,path:"/signin",component:w}),Object(k.jsx)(l.b,{exact:!0,path:"/books",component:ee}),Object(k.jsx)(l.b,{exact:!0,path:"/cart",component:Ne}),Object(k.jsx)(l.b,{path:"/books/:id",component:ie}),Object(k.jsx)(l.b,{exact:!0,path:"/not-found",component:ye}),Object(k.jsx)(l.b,{path:"*",children:Object(k.jsx)(l.a,{to:"/no-found"})})]})})]}):Object(k.jsxs)(k.Fragment,{children:[c.isError&&Object(k.jsx)(ke,{error:!0,data:c}),t.message&&Object(k.jsx)(ke,{message:t.message}),Object(k.jsx)(o.a,{basename:"/js-book-store",children:Object(k.jsxs)(l.d,{children:[Object(k.jsx)(l.b,{exact:!0,path:"/signin",component:w}),Object(k.jsx)(l.b,{exact:!0,path:"/not-found",component:ye}),Object(k.jsx)(l.b,{path:"*",children:Object(k.jsx)(l.a,{to:"/signin"})})]})})]})}var Ee=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,50)).then((function(t){var c=t.getCLS,r=t.getFID,a=t.getFCP,n=t.getLCP,s=t.getTTFB;c(e),r(e),a(e),n(e),s(e)}))},we=c(14),Le=c(31),_e=c(2),Re={username:null,token:null,avatar:null,isLoading:!1,error:null};var Ae={catalog:[],filterCondition:{title:function(){return!0},price:function(){return!0}},filteredCatalog:null,single:null,isCatalogLoading:!1,isSingleLoading:!1,error:null},Te=function(e){return function(t){var c=t.title,r=t.price;return e.title(c)&&e.price(r)}};var Ie=[];var Pe={isSending:!1,isSuccess:!1,error:null};var Be={message:null,title:null,onClose:null};var Ue=Object(we.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(_e.a)({isLoading:!1,error:null},t.payload);case f:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!1,error:t.payload});case v:return Object(_e.a)(Object(_e.a)({},e),{},{error:null});case g:return Object(_e.a)(Object(_e.a)({},e),{},{isLoading:!0});case N:return Object(_e.a)({},Re);default:return e}},books:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return Object(_e.a)(Object(_e.a)({},e),{},{catalog:t.payload,isCatalogLoading:!1});case U:return Object(_e.a)(Object(_e.a)({},e),{},{isCatalogLoading:!0});case D:return Object(_e.a)(Object(_e.a)({},e),{},{single:t.payload,isSingleLoading:!1});case F:return Object(_e.a)(Object(_e.a)({},e),{},{isSingleLoading:!0});case P:return Object(_e.a)(Object(_e.a)({},e),{},{error:t.payload});case B:return Object(_e.a)(Object(_e.a)({},e),{},{error:null});case K:return Object(_e.a)(Object(_e.a)({},e),{},{single:null});case G:return Object(_e.a)(Object(_e.a)({},e),{},{filterCondition:Object(_e.a)(Object(_e.a)({},e.filterCondition),{},{price:t.payload})});case J:return Object(_e.a)(Object(_e.a)({},e),{},{filterCondition:Object(_e.a)(Object(_e.a)({},e.filterCondition),{},{title:t.payload})});case H:return Object(_e.a)(Object(_e.a)({},e),{},{filteredCatalog:e.catalog.filter(Te(e.filterCondition))});case Y:return Object(_e.a)(Object(_e.a)({},e),{},{filteredCatalog:null});default:return e}},cart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case re:return[].concat(Object(oe.a)(e),[Object(_e.a)(Object(_e.a)({},t.payload),{},{key:e.length})]);case ae:return[];default:return e}},purchase:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case de:return Object(_e.a)(Object(_e.a)({},e),{},{isSending:!0});case be:return Object(_e.a)(Object(_e.a)({},e),{},{isSuccess:!0,isSending:!1});case ue:return Object(_e.a)(Object(_e.a)({},e),{},{error:t.payload,isSending:!1});case je:return Object(_e.a)(Object(_e.a)({},e),{},{error:null});case Oe:return Object(_e.a)({},Pe);default:return e}},modal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ve:return Object(_e.a)({},t.payload);case ge:return Object(_e.a)({},Be);default:return e}}}),De=Object(we.d)(Ue,Object(we.a)(Le.a));s.a.render(Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(i.a,{store:De,children:Object(k.jsx)(Se,{})})}),document.getElementById("root")),Ee()}},[[49,1,2]]]);
//# sourceMappingURL=main.40742e1b.chunk.js.map